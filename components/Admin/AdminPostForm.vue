<template>
  <form @submit.prevent="onSave">
    <AppControlInput v-model="editedPost.author">Author Name</AppControlInput>
    
    <AppControlInput v-model="editedPost.title">Title</AppControlInput>
            
    <AppControlInput v-model="editedPost.thumbnail">Thumbnail Link</AppControlInput>
            
    <AppControlInput
              control-type="textarea"
              v-model="editedPost.content">Content</AppControlInput>
    <AppControlInput
              control-type="textarea"
              v-model="editedPost.previewText">Preview Text</AppControlInput>
            
    <AppButton type="submit">Save</AppButton>
            
    <AppButton
      type="button"
      style="margin-left: 10px"
      btn-style="cancel"
      @click="onCancel">Cancel</AppButton>
  </form>
</template>
<script lang="ts">
import { Component, Vue, Prop, Emit } from 'nuxt-property-decorator'

/**
 * 文章格式
 */
interface Post {
  readonly author: string;
  readonly title: string;
  readonly thumbnail: string;
  readonly content:  string;
  readonly previewText: string;
}

@Component
export default class AdminPostForm extends Vue {
  /**
   * 文章
   */
  @Prop({ type: Object, required: false })
  readonly post: Post | undefined;
  // get editedPost(): Post{
  //   return this.post 
  //   ? { ...this.post } 
  //   : {
  //     author:"",
  //     title:"",
  //     thumbnail: "",
  //     content: "",
  //     previewText:"",
  //   }
  // }

  /**
   * 編輯文章
   */
  public editedPost:Post = 
  {
      author:"",
      title:"",
      thumbnail: "",
      content: "",
      previewText:"",
  };

  /**
   * 儲存文章，觸發submit事件
   */
  @Emit('submit')
  public onSave(){
    return this.editedPost
  };

  /**
   * 取消編輯
   */
  public onCancel(){
    this.$router.push('/admin');
  };

  /**
   * 如果有擷取到文章，載入文章
   */
  created() {
    if (this.post){
      this.editedPost = this.post
    }
  };
}
</script>
<!--script>
import AppControlInput from '@/components/UI/AppControlInput'
import AppButton from '@/components/UI/AppButton'
export default {
  components:{
    AppControlInput,
    AppButton
  },
  props:{
    post:{
      type: Object,
      required: false
    }
  },
  data(){
    return{
      editedPost:this.post
      ? { ...this.post } 
      : {
        author:"",
        title:"",
        thumbnail: "",
        content: "",
        previewText:"",
      }`
    }
  },
  methods:{
    onSave(){
      // 儲存文章
      this.$emit('submit',this.editedPost)
    },
    onCancel(){
      // 上一步
      this.$router.push('/admin')
    }
  }
}
</script-->